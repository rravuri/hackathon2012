<html><body>
<style>
.we_main {
	font-family:Segoe UI;
	color:gray;
	border-radius: 0px 0px 0px 6px;
	position: absolute;
	padding: 3px;
	top: 0px;
	right: 0px;
	width: 170px;
	height:20px;
	font-size:18px;
	box-shadow: 2px -2px 3px 0px lightgray inset;
}

.we_mainExpanded{
	height:800px;
}

#we_contacts section,	#we_contacts .we_pointer, #we_contacts h1, #we_contacts p {
	-webkit-transition: all 0.5s ease-in-out;
	-moz-transition: all 0.5s ease-in-out;
	-o-transition: all 0.5s ease-in-out;
	-ms-transition: all 0.5s ease-in-out;	
	transition: all 0.5s ease-in-out;
}

#we_contacts{
	position:relative;
	display:none;
}

#we_contacts h1 {
	font-size:10px;
	background-color:rgba(52,52,52,0.3);
	margin:0;
	padding: 5px 5px 15px 20px;
	color:#000;		
}
#we_contacts h1 a {
}
#we_contacts section {
	overflow:hidden;
	height:300px;
	border-right:1px #ccc solid;
	border-left:1px #ccc solid;
	border-bottom:1px #ccc solid;
}
#we_contacts p {
	padding:0 10px;
	color:#fff;
	margin:0;
}
#we_contacts section.we_achidden p:not(.pointer) {
	color:#000;
}

#we_contacts section.we_achidden {
	height:24px;
}
#we_contacts section.we_achidden div.we_content{
	display:none;
}
#we_contacts .we_pointer {
	padding:0;
	margin:4px 0 0 2px;
	line-height:10px;
	width:10px;
	position:absolute;		
}
#we_contacts section:not(.we_achidden) h1 {
	background-color:rgba(52,52,52,0.7);
	color:#fff;
}

#we_contacts section:not(.we_achidden) .we_pointer {
	display:block;
	transform:rotate(90deg);						
	padding:0;
}
#we_contacts section.we_achidden path {
	fill:gray;
}
path {
	fill:white;
}
#we_connect path{
	fill:gray;
}
.we_myview{
	display:block;
	width:64px;
	height:64px;
	background:black;
}
</style>
<div id="page">
	<div id="header" class="header">
		<div id="ssb_block_1" class="ssb_block">
			<div id="authentication">
				<p id="skip"></p>
				<h2 class="structure">User authentication</h2>
				<p>
				Hello Rakesh. <a href="/direct/my/sign-out.page" onclick="s_objectID=&quot;http://www.tesco.com/direct/my/sign-out.page_1&quot;;return this.s_oc?this.s_oc(e):true"><em>Not you?</em></a>
				</p>
			</div>
		</div>
	</div>
</div>
<div id="test"><p></p></div>
<script src="jquery-1.5.1.min.js"></script>
<div id="we_main" class="we_main">
	<div id="we_connect">
		<p style="margin:0"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" 
		width="20px" height="20px" viewBox="0 0 100 64.122" enable-background="new 0 0 100 64.122" space="preserve">
<g>
	<path fill="#010101" d="M66.442,25.271c0,0-0.613,1.909-0.71,2.164c-0.097,0.256-0.687,1.047-0.559,1.047
		c0.126,0,1.43,0.604,1.43,0.604l5.062,1.572l-0.073,2.385c-0.444,0.065-2.192,1.223-2.447,1.795
		c-0.165,0.374-0.536,1.041-0.892,1.503c4.61,1.859,7.308,4.581,7.417,7.628c0.075,0.543,2.872,10.526,3.032,12.773H100
		c0.018-0.093-0.642-13.007-0.648-13.104c0,0-1.223-3.11-3.16-3.426c-1.94-0.318-4.429-0.995-5.47-1.781
		c-0.608-0.462-2.591-1.264-3.51-1.598c-0.428-0.154-1.162-1.422-1.415-1.995c-0.253-0.571-2.003-1.729-2.447-1.793l-0.072-2.386
		l5.061-1.572c0,0,1.305-0.604,1.431-0.604c0.128,0-0.604-0.959-0.698-1.215c-0.096-0.254-0.572-1.993-0.572-1.993
		s1.709,2.088,2.574,2.479c0,0-1.701-3.195-2.207-4.973c-0.51-1.781-0.844-4.562-0.844-4.815c0-0.256-1.05-7.723-1.621-8.962
		c-0.572-1.24-1.348-2.924-2.677-3.751c-1.329-0.826-3.298-2.002-6.127-2.161c-0.041-0.001-0.083-0.001-0.126-0.005
		c-0.042,0.004-0.084,0.004-0.128,0.005c-2.828,0.158-4.797,1.334-6.126,2.161c-1.326,0.827-2.104,2.511-2.676,3.751
		c-0.573,1.239-1.622,8.706-1.622,8.962c0,0.253-0.296,3.148-0.804,4.926c-0.508,1.781-2.245,4.862-2.245,4.862
		C64.737,27.36,66.442,25.271,66.442,25.271z"></path>
</g>
<g>
	<path fill="#010101" d="M22.398,45.956v-0.131l0.014-0.128c1.378-5.949,8.546-8.791,12.459-10.496c0.006-0.003-0.006,0.001,0,0
		c-2.375-1.086-3.629-1.896-4.216-2.028c-0.24-0.482-0.755-4.117-0.755-4.117s2.855-2.522,3.496-7.354c0,0,1.406,0.778,1.494-2.162
		c0.065-2.265,0.456-3.15-1.085-3.812c0,0,0.111-1.567,0.16-2.958c0.077-2.062,0.457-4.956-3.111-7.283
		C30.347,5.156,27.73,3.7,27.713,3.708c-0.933-0.566-2.118-0.927-2.118-0.927l0.038,0.85c-0.064-0.062-0.128-0.129-0.187-0.187
		c-0.235-0.243-0.368-1.18-0.345-1.551c0.046-0.659,0.046-0.659,0.046-0.659c-1.69,1.261-2.856,2.89-2.856,2.89l0.151-1.576
		c0,0-0.313,0.483-4.18,2.897c-3.793,2.368-3.165,5.863-3.061,7.932c0.07,1.391,0.208,2.35,0.208,2.35
		c-1.54,0.662-0.733,1.607-0.694,3.872c0.05,3.133,1.629,2.581,1.629,2.581c0.727,4.268,2.969,6.875,2.969,6.875
		s-0.634,3.656-0.878,4.119c-0.699,0.157-2.313,1.271-5.7,2.681c-4.991,2.077-3.424,0.872-7.486,2.902
		c-6.42,3.21-5.147,16.6-5.147,16.6h20.226L22.398,45.956z"></path>
</g>
<g>
	<path fill="#010101" d="M77.525,64.122c0-3.817-4.31-19.96-4.31-19.96c0-2.359-3.103-5.054-9.22-6.624
		c-3.175-0.814-5.837-2.639-5.837-2.639c-0.393-0.223-0.333-2.284-0.333-2.284l-1.97-0.297c0-0.168-0.167-2.639-0.167-2.639
		c2.356-0.786,2.113-5.425,2.113-5.425c1.496,0.824,2.47-2.843,2.47-2.843c1.771-5.099-0.881-4.792-0.881-4.792
		c0.842-3.816,0-9.392,0-9.392C58.212-3.102,40.466-0.298,42.57,3.076c-5.186-0.954-4.003,10.773-4.003,10.773l1.125,3.032
		c-2.209,1.421-0.674,3.144-0.599,5.126C39.201,24.932,41,24.326,41,24.326c0.112,4.828,2.506,5.462,2.506,5.462
		c0.45,3.032,0.17,2.516,0.17,2.516l-2.133,0.256c0.095,0.766-0.168,2.056-0.168,2.056c-2.513,1.11-3.048,1.762-5.54,2.845
		c-4.815,2.096-10.049,4.822-10.978,8.492c-0.93,3.671-3.691,18.166-3.691,18.166h56.358V64.122z"></path>
</g>
</svg>
		</p><p style="position:absolute;top:0px;right:50px;margin:0px">We Connect</p> 
	</div>
	<div class="we_myview"></div>
	<div id="we_contacts" >
		<section id="we_friend1">
			<p class="we_pointer">
				<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" 
				id="Layer_1" x="0px" y="0px" width="15px" height="15px" viewBox="0 -8 100 100" enable-background="new 0 -8 100 100" space="preserve">
					<path d="M44.021,53.015c-2.685-2.499-3.958-4.594-3.943-6.483l-12.586-0.042C13.461,46.544,1.187,69.854,0.723,84.597  c4.291,0.001,22.51,0.011,42.708,0.015l-3.446-4.077L44.021,53.015z"></path>
					<path d="M85.318,53.255c-4.383-4.389-8.955-6.615-13.59-6.615l-12.337-0.042c-0.016,1.871-1.29,3.944-3.944,6.417l4.035,27.521  l-3.447,4.078c17.021,0.001,33.712-0.003,43.241-0.017C98.934,75.731,93.667,61.617,85.318,53.255z"></path>
					<path d="M49.622,38.711l0.106,0l0.119,0c10.948,0,19.895-9.19,19.94-20.487C69.74,6.982,60.742-2.208,49.729-2.251  c-5.344,0.021-10.375,2.137-14.155,5.958c-3.836,3.876-5.929,9.03-5.894,14.513c-0.036,5.566,2.067,10.761,5.922,14.64  C39.35,36.634,44.33,38.711,49.622,38.711z"></path>
					<path d="M52.207,50.882c3.057-2.678,3.392-3.976,3.423-4.297c0.006-0.054,0.003-0.082,0.003-0.084  c-0.056-0.283-0.267-0.574-0.576-0.857c-0.372-0.338-0.895-0.663-1.507-0.943c-1.133-0.52-2.554-0.88-3.817-0.88  c-1.239,0-2.634,0.35-3.757,0.855c-0.613,0.274-1.143,0.596-1.525,0.932c-0.334,0.293-0.558,0.598-0.616,0.894  c0,0-0.001,0.018,0,0.044c0.009,0.235,0.22,1.528,3.427,4.337l0.77,0.674l-4.085,27.847l4.403,5.211l0.794,0.938l0.591,0.701  l0.592-0.7l0.793-0.938l4.404-5.21l-4.084-27.849L52.207,50.882z"></path>
				</svg>
			</p><h1>Customer Service</h1>
			<div class="we_content" style='height:100%'>
				<input id="we_tocsa" type='text' value='chat' style='position:absolute;top:270px;width:165px'/>
			</div>
			
		</section>
	</div>
</div>
<script type="text/javascript">
$(document).ready(function() {
	var localStream;
	var getUserMedia = function(success,fail) {
		try {
		  navigator.webkitGetUserMedia({audio:true, video:true}, success,
									   fail);
		  console.log("Requested access to local media with new syntax.");
		} catch (e) {
		  try {
			navigator.webkitGetUserMedia("video,audio", success,
										 fail);
			console.log("Requested access to local media with old syntax.");
		  } catch (e) {
			alert("webkitGetUserMedia() failed. Is the MediaStream flag enabled in about:flags?");
			console.log("webkitGetUserMedia failed with exception: " + e.message);
		  }
		}
	}
	
	var toggleUser=function(e){
		$(this).parents().siblings("section").addClass("we_achidden");
		$(this).parents("section").removeClass("we_achidden");
		
		e.preventDefault();
	}
	
	var toggleMyView=function(e){
		if (localStream!=undefined)
		{
			return;
		}
		var myvideo=$("<video autoplay height='100%' width='100%' controls='true'></video>");
		$(".we_myview").append(myvideo);
		getUserMedia(
			function(stream){
				console.log("User has granted access to local media.");
				var url = webkitURL.createObjectURL(stream);
				console.log(url);
				console.log(JSON.stringify(stream));
				//myvideo.style.opacity = 1;
				myvideo.attr('src',url);
				localStream = stream;
			},
			function(error){
				console.log("Error accesing camera:"+JSON.stringify(error));
			}
		);
	}
	
	$(".we_myview").click(toggleMyView);
	
	var user=$("#authentication p:last").text().split(" ")[1].split(".")[0];
	
	$("#we_tocsa").click(function(e){
		this.value="";
	});
	$("#we_tocsa").keydown(function(e){
		var msg=this.value;
		//console.log(e);
		if (e.keyCode!=13)
		return;
		
		$.ajax({
			type:'POST',
			url:"http://127.0.0.1:8880/send?from="+user+"&to=csa&msg="+ msg +"&callback=?",
			dataType:'json',
			data:{msg:this.value,from:user},
			success:function(data){
				console.log(data);
			}
		});
		e.preventDefault();
	});
	
	$.getJSON("http://127.0.0.1:8880/user?name="+user+"&callback=?",function(userdata){
		var i;
		 var level2list=$("#navigation ul.navigation-level-1 li.first div.navigation-level-2 ul").append("<li><h3>Shared Collection</h3></li>")
		for( i=0;i<userdata.friends.length;i+=1)
		{
			var frnd=userdata.friends[i];
		
			var newsection=$("<section class='we_achidden'></section>");
			var newp=$("<p class='we_pointer'></p>");
			newsection.append(newp)
			newp.append('<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" width="15px" height="15px" viewBox="0 0 100 100" enable-background="new 0 0 100 100" space="preserve"><g><path d="M34.17,62.932l1.099,0.273c4.332-5.283,7.815-12.215,2.554-19.435c-5.44-7.471-7.457-17.142-5.071-26.328   C36.532,2.886,42.756,0.366,57.405,0.43c5.008,0.022,15.456,1.76,18.607,6.126c0.792,1.095-0.53,2.522,0.014,3.17   c1.979,2.35,3.346,6.891,3.852,11.311c0.104,0.923,2.023,3.147,1.537,4.047c-0.989,1.821-1.444,2.771,0.302,5.242   c1.136,1.61,4.413,6.442,5.144,7.774c1.021,1.857-4.852,1.917-4.337,3.33c0.234,0.644,1.025,2.271,1.28,2.902   c0.308,0.762-1.519,1.247-1.528,1.777c0.003,0.202,1.126,0.309,0.949,1.637c-0.108,0.817-1.757,0.177-1.851,3.282   c-0.05,1.686,1.967,4.035-1.403,6.168c-3.623,2.297-16.219-4.463-17.27,8.309c-0.147,1.795-0.103,3.277,0.08,4.547l1.9,0.473   c0,0,0.624,3.211,1.39,6.51c0.45,0.602,0.896,1.207,1.307,1.869c2.723,4.393,7.992,9.795,8.916,15.326   c0.419,2.518,0.566,4.053,0.603,4.979H17.021c0.052-3.385-1.78-14.852,11.745-29.113l0.37-0.385L34.17,62.932L34.17,62.932z"></path></g></svg>');
			var newh1=$("<h1>"+frnd+"</h1>");
			newsection.append(newh1);
			$("#we_contacts").append(newsection);
			newh1.click(toggleUser);
		} 
	});
	
	$("#we_contacts section h1").click(toggleUser);
	
	var expanded=0;
	$("#we_connect").click(function(e) {
		if (expanded)
		{
			$("#we_main").removeClass("we_mainExpanded");
			$("#we_contacts").hide('slow',function(){
			});
			expanded=0;
		}
		else
		{
			$("#we_main").addClass("we_mainExpanded");
			$("#we_contacts").show('slow',function(){
			});
			expanded=1;
		}
		e.preventDefault();
	});
});
</script>
</body></html>